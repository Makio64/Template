var Main, main,
  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

main = null;

Main = (function() {
  Main.prototype.dt = 0;

  Main.prototype.lastTime = 0;

  Main.prototype.pause = false;

  function Main() {
    this.resize = __bind(this.resize, this);
    this.update = __bind(this.update, this);
    this.pause = false;
    this.lastTime = Date.now();
    window.focus();
    if (PIXI) {
      Stage2d.init({
        transparent: false,
        antialias: false,
        background: 0xFF0000
      });
    }
    if (THREE) {
      Stage3d.init({
        transparent: false,
        antialias: false,
        background: 0x0000FF
      });
    }
    requestAnimationFrame(this.update);
    return;
  }

  Main.prototype.update = function() {
    var dt, t;
    t = Date.now();
    dt = t - this.lastTime;
    this.lastTime = t;
    if (this.pause) {
      return;
    }
    SceneTraveler.update(dt);
    if (PIXI) {
      Stage2d.render();
    }
    if (THREE) {
      Stage3d.render();
    }
    requestAnimationFrame(this.update);
  };

  Main.prototype.resize = function() {
    var height, width;
    width = window.innerWidth;
    height = window.innerHeight;
    SceneTraveler.resize();
  };

  return Main;

})();

document.addEventListener('DOMContentLoaded', function() {
  main = new Main();
  window.onblur = function(e) {
    main.pause = true;
    cancelAnimationFrame(main.update);
  };
  window.onfocus = function() {
    requestAnimationFrame(main.update);
    main.lastTime = Date.now();
    main.pause = false;
  };
  window.onresize = function() {
    main.resize();
  };
});

//# sourceMappingURL=data:application/json;base64,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QUFBLElBQ0EsSUFBSSxDQUFDLFFBQUwsR0FBZ0IsSUFBSSxDQUFDLEdBQUwsQ0FBQSxDQURoQixDQUFBO0FBQUEsSUFFQSxJQUFJLENBQUMsS0FBTCxHQUFhLEtBRmIsQ0FEZ0I7RUFBQSxDQVBqQixDQUFBO0FBQUEsRUFhQSxNQUFNLENBQUMsUUFBUCxHQUFrQixTQUFBLEdBQUE7QUFDakIsSUFBQSxJQUFJLENBQUMsTUFBTCxDQUFBLENBQUEsQ0FEaUI7RUFBQSxDQWJsQixDQUQ2QztBQUFBLENBQTlDLENBbERBLENBQUEiLCJmaWxlIjoiTWFpbi5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbIiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIEdsb2JhbCB2YXJcblxubWFpbiA9IG51bGxcblxuIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gQ2xhc3MgTWFpblxuXG5jbGFzcyBNYWluXG5cblx0ZHQgXHRcdFx0XHQ6IDBcblx0bGFzdFRpbWUgXHRcdDogMFxuXHRwYXVzZSBcdFx0XHQ6IGZhbHNlXG5cblx0Y29uc3RydWN0b3I6KCktPlxuXHRcdEBwYXVzZSA9IGZhbHNlXG5cdFx0QGxhc3RUaW1lID0gRGF0ZS5ub3coKVxuXHRcdHdpbmRvdy5mb2N1cygpXG5cdFx0aWYgUElYSVxuXHRcdFx0U3RhZ2UyZC5pbml0KHt0cmFuc3BhcmVudDpmYWxzZSxhbnRpYWxpYXM6ZmFsc2UsIGJhY2tncm91bmQ6MHhGRjAwMDB9KVxuXHRcdGlmIFRIUkVFXG5cdFx0XHRTdGFnZTNkLmluaXQoe3RyYW5zcGFyZW50OmZhbHNlLGFudGlhbGlhczpmYWxzZSwgYmFja2dyb3VuZDoweDAwMDBGRn0pXG5cdFx0XG5cdFx0cmVxdWVzdEFuaW1hdGlvbkZyYW1lKCBAdXBkYXRlIClcblx0XHRyZXR1cm5cblxuXHR1cGRhdGU6KCk9PlxuXHRcdHQgPSBEYXRlLm5vdygpXG5cdFx0ZHQgPSB0IC0gQGxhc3RUaW1lXG5cdFx0QGxhc3RUaW1lID0gdFxuXG5cdFx0aWYgQHBhdXNlIHRoZW4gcmV0dXJuXG5cblx0XHQjIHVwZGF0ZSBsb2dpYyBoZXJlXG5cdFx0U2NlbmVUcmF2ZWxlci51cGRhdGUoZHQpXG5cdFx0XG5cdFx0IyByZW5kZXIgZnJhbWVcblx0XHRpZiBQSVhJXG5cdFx0XHRTdGFnZTJkLnJlbmRlcigpXG5cdFx0aWYgVEhSRUVcblx0XHRcdFN0YWdlM2QucmVuZGVyKClcblxuXHRcdHJlcXVlc3RBbmltYXRpb25GcmFtZSggQHVwZGF0ZSApXG5cdFx0cmV0dXJuXG5cblx0cmVzaXplOigpPT5cblx0XHR3aWR0aCBcdD0gd2luZG93LmlubmVyV2lkdGhcblx0XHRoZWlnaHQgXHQ9IHdpbmRvdy5pbm5lckhlaWdodFxuXHRcdFNjZW5lVHJhdmVsZXIucmVzaXplKClcblx0XHRyZXR1cm5cblxuXG4jLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBvbiBEb2N1bWVudCBSZWFkeVxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCktPlxuXHRtYWluID0gbmV3IE1haW4oKVxuXHRcblx0d2luZG93Lm9uYmx1ciA9IChlKS0+XG5cdFx0bWFpbi5wYXVzZSA9IHRydWVcblx0XHRjYW5jZWxBbmltYXRpb25GcmFtZShtYWluLnVwZGF0ZSlcblx0XHRyZXR1cm5cblxuXHR3aW5kb3cub25mb2N1cyA9ICgpLT5cblx0XHRyZXF1ZXN0QW5pbWF0aW9uRnJhbWUobWFpbi51cGRhdGUpXG5cdFx0bWFpbi5sYXN0VGltZSA9IERhdGUubm93KClcblx0XHRtYWluLnBhdXNlID0gZmFsc2Vcblx0XHRyZXR1cm5cblxuXHR3aW5kb3cub25yZXNpemUgPSAoKS0+XG5cdFx0bWFpbi5yZXNpemUoKVxuXHRcdHJldHVyblxuXG5cdHJldHVyblxuKSJdfQ==